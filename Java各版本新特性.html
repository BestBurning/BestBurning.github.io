<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="正走在通向编程、艺术、摄影、剪辑、写作、运动的路上的Full Stacker,Stay Cool!!!"><meta name="google-site-verification" content="q2XooBg_4_mx5-YvLlJvWzU3gxn_9nUvFpLz2_pU584"><meta name="keywords" content="Java,JDK,版本,新特性,8,9,10,11,12,13,14,15"><title>Java各版本新特性 - 第一帅</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.1"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-163115360-1','auto');ga('send','pageview');
</script><script>(function () {
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Java各版本新特性</h1><a id="logo" href="/.">第一帅</a><p class="description">Shea的博客</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tags/"><i class="fa fa-tag"> 标签</i></a><a href="/products/"><i class="fa fa-cubes"> 作品</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/guestbook/"><i class="fa fa-comments"> 留言</i></a><a href="/history/"><i class="fa fa-book"> 历史</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Java各版本新特性</h1><div class="post-meta">2020-08-30<span> | </span><span class="category"><a href="/categories/technology/">technology</a><span>  </span></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><a class="disqus-comment-count" data-disqus-identifier="Java各版本新特性.html" href="/Java各版本新特性.html#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JDK各版本特性"><span class="toc-number">1.</span> <span class="toc-text">JDK各版本特性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#历史版本主要特性"><span class="toc-number">1.1.</span> <span class="toc-text">历史版本主要特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-8"><span class="toc-number">1.2.</span> <span class="toc-text">1.8</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Lambda表达式"><span class="toc-number">1.2.1.</span> <span class="toc-text">Lambda表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stream-API"><span class="toc-number">1.2.2.</span> <span class="toc-text">Stream API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Interface"><span class="toc-number">1.2.3.</span> <span class="toc-text">Interface</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Date-Time-API-LocalDate-amp-LocalDateTime"><span class="toc-number">1.2.4.</span> <span class="toc-text">Date Time API - LocalDate &amp; LocalDateTime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Optional"><span class="toc-number">1.2.5.</span> <span class="toc-text">Optional</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64-java-util-Base64"><span class="toc-number">1.2.6.</span> <span class="toc-text">Base64 - java.util.Base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方法引用"><span class="toc-number">1.2.7.</span> <span class="toc-text">方法引用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JVM的新特性-Metaspace-替代-PermGen-space"><span class="toc-number">1.2.8.</span> <span class="toc-text">JVM的新特性 - Metaspace 替代 PermGen space</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9"><span class="toc-number">1.3.</span> <span class="toc-text">9</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#模块化"><span class="toc-number">1.3.1.</span> <span class="toc-text">模块化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不可变集合工厂方法"><span class="toc-number">1.3.2.</span> <span class="toc-text">不可变集合工厂方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#接口支持私有方法"><span class="toc-number">1.3.3.</span> <span class="toc-text">接口支持私有方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Optional-改进"><span class="toc-number">1.3.4.</span> <span class="toc-text">Optional 改进</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#try-with-resources-改进"><span class="toc-number">1.3.5.</span> <span class="toc-text">try-with-resources 改进</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stream-API-更新"><span class="toc-number">1.3.6.</span> <span class="toc-text">Stream API 更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多版本兼容Jar包"><span class="toc-number">1.3.7.</span> <span class="toc-text">多版本兼容Jar包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他"><span class="toc-number">1.3.8.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10"><span class="toc-number">1.4.</span> <span class="toc-text">10</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#局部变量类型推断"><span class="toc-number">1.4.1.</span> <span class="toc-text">局部变量类型推断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不可变集合更新"><span class="toc-number">1.4.2.</span> <span class="toc-text">不可变集合更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#并行全垃圾回收器G1"><span class="toc-number">1.4.3.</span> <span class="toc-text">并行全垃圾回收器G1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线程本地握手"><span class="toc-number">1.4.4.</span> <span class="toc-text">线程本地握手</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Optional-更新-orElseThrow"><span class="toc-number">1.4.5.</span> <span class="toc-text">Optional 更新 orElseThrow()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他-1"><span class="toc-number">1.4.6.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11"><span class="toc-number">1.5.</span> <span class="toc-text">11</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串-API更新"><span class="toc-number">1.5.1.</span> <span class="toc-text">字符串 API更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lambda-推断类型参数的局部变量语法"><span class="toc-number">1.5.2.</span> <span class="toc-text">Lambda 推断类型参数的局部变量语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTPClient-标准化"><span class="toc-number">1.5.3.</span> <span class="toc-text">HTTPClient 标准化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单文件java命令直接编译运行"><span class="toc-number">1.5.4.</span> <span class="toc-text">单文件java命令直接编译运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZGC-可伸缩低延迟垃圾收集器"><span class="toc-number">1.5.5.</span> <span class="toc-text">ZGC-可伸缩低延迟垃圾收集器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他-2"><span class="toc-number">1.5.6.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12"><span class="toc-number">1.6.</span> <span class="toc-text">12</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#switch-增强-预览"><span class="toc-number">1.6.1.</span> <span class="toc-text">switch 增强(预览)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NumberFormat-数字的格式化"><span class="toc-number">1.6.2.</span> <span class="toc-text">NumberFormat - 数字的格式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串支持transform、indent操作"><span class="toc-number">1.6.3.</span> <span class="toc-text">字符串支持transform、indent操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Files-mismatch-Path-Path"><span class="toc-number">1.6.4.</span> <span class="toc-text">Files.mismatch(Path, Path)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Teeing-Collector"><span class="toc-number">1.6.5.</span> <span class="toc-text">Teeing Collector</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他-3"><span class="toc-number">1.6.6.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13"><span class="toc-number">1.7.</span> <span class="toc-text">13</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Switch-增强-yield"><span class="toc-number">1.7.1.</span> <span class="toc-text">Switch 增强 - yield</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#String文本块"><span class="toc-number">1.7.2.</span> <span class="toc-text">String文本块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SocketAPI-重构"><span class="toc-number">1.7.3.</span> <span class="toc-text">SocketAPI 重构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileSystems-newFileSystem"><span class="toc-number">1.7.4.</span> <span class="toc-text">FileSystems.newFileSystem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZGC-增强-释放未使用内存"><span class="toc-number">1.7.5.</span> <span class="toc-text">ZGC 增强 - 释放未使用内存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他-4"><span class="toc-number">1.7.6.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14"><span class="toc-number">1.8.</span> <span class="toc-text">14</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#instanceof-模式匹配改进"><span class="toc-number">1.8.1.</span> <span class="toc-text">instanceof 模式匹配改进</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#switch-表达式-标准化"><span class="toc-number">1.8.2.</span> <span class="toc-text">switch 表达式 - 标准化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Record-类型（预览功能）"><span class="toc-number">1.8.3.</span> <span class="toc-text">Record 类型（预览功能）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NullPointerException-提示改进"><span class="toc-number">1.8.4.</span> <span class="toc-text">NullPointerException 提示改进</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他-5"><span class="toc-number">1.8.5.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15"><span class="toc-number">1.9.</span> <span class="toc-text">15</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EdDSA-数字签名算法"><span class="toc-number">1.9.1.</span> <span class="toc-text">EdDSA 数字签名算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sealed-Classes（封闭类，预览）"><span class="toc-number">1.9.2.</span> <span class="toc-text">Sealed Classes（封闭类，预览）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hidden-Classes（隐藏类）"><span class="toc-number">1.9.3.</span> <span class="toc-text">Hidden Classes（隐藏类）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他-6"><span class="toc-number">1.9.4.</span> <span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#源码"><span class="toc-number">1.10.</span> <span class="toc-text">源码</span></a></li></ol></li></ol></div></div><div class="post-content"><h1 id="JDK各版本特性"><a href="#JDK各版本特性" class="headerlink" title="JDK各版本特性"></a>JDK各版本特性</h1><h2 id="历史版本主要特性"><a href="#历史版本主要特性" class="headerlink" title="历史版本主要特性"></a>历史版本主要特性</h2><p><strong>JDK 1.5</strong> ：enum、泛型，自动装箱与拆箱、可变参数、增强循环</p>
<p>JDK 1.6 ：支持脚本语言、JDBC4.0API</p>
<p>JDK 1.7： 支持try-with-resources、switch语句块增加String支持、NIO2.0包</p>
<p><strong>JDK 1.8</strong>： lambda表达式、Stream API、新的日期时间的API、方法引用、构造器引用</p>
<p>JDK 9 ： 模块化系统、jshell</p>
<p>JDK 10 ： 局部变量的类型推断</p>
<p><strong>JDK 11</strong>： ZGC的引入、Epsilon GC</p>
<p>JDK 12： switch表达式、Shenandoah GC、增强GC</p>
<p>JDK 13： switch表达式引入yield、文本块</p>
<p>JDK14 ：instanceof 模式识别、Records、启用Parallel Scavenge+Serial GC组合、删除CMS GC</p>
<h2 id="1-8"><a href="#1-8" class="headerlink" title="1.8"></a>1.8</h2><p><img src="https://images.di1shuai.com/2021-01-23-1.8.png" alt></p>
<h3 id="Lambda表达式"><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.out.println(<span class="string">"foreach-less1.8"</span>);</span><br><span class="line"><span class="comment">//foreach-less1.8</span></span><br><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>,<span class="string">"c"</span>);</span><br><span class="line"><span class="keyword">for</span> (String str:strings) &#123;</span><br><span class="line">    System.out.println(str);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">"-------"</span>);</span><br><span class="line">System.out.println(<span class="string">"foreach 1.8"</span>);</span><br><span class="line"><span class="comment">//foreach 1.8</span></span><br><span class="line">strings.forEach(str -&gt; System.out.println(str));</span><br></pre></td></tr></table></figure>

<h3 id="Stream-API"><a href="#Stream-API" class="headerlink" title="Stream API"></a>Stream API</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//stream</span></span><br><span class="line">strings.stream()</span><br><span class="line">        .distinct()</span><br><span class="line">        .limit(<span class="number">2</span>)</span><br><span class="line">        .filter(str -&gt; str == <span class="string">"a"</span>)</span><br><span class="line">        .forEach(str -&gt; System.out.println(str));</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">"==========="</span>);</span><br><span class="line">System.out.println(<span class="string">"peek"</span>);</span><br><span class="line">strings.parallelStream()</span><br><span class="line">        .skip(<span class="number">2</span>)</span><br><span class="line">        .forEach(str -&gt; System.out.println(str));</span><br><span class="line">System.out.println(<span class="string">"==========="</span>);</span><br><span class="line">distinctPrimary(<span class="string">"12"</span>,<span class="string">"23"</span>,<span class="string">"12"</span>,<span class="string">"23"</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">distinctPrimary</span><span class="params">(String...numbers)</span> </span>&#123;</span><br><span class="line">        List&lt;String&gt; strings = Arrays.asList(numbers);</span><br><span class="line">        List&lt;Integer&gt; collect = strings.parallelStream()</span><br><span class="line">                .map(e -&gt; <span class="keyword">new</span> Integer(e))</span><br><span class="line"><span class="comment">//              .filter(e -&gt; Primes.isPrime(e))</span></span><br><span class="line">                .distinct()</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(collect);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="Interface"><a href="#Interface" class="headerlink" title="Interface"></a>Interface</h3><ul>
<li>默认方法</li>
<li>静态方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">jump</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.getClass().getSimpleName()+ <span class="string">" jump"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(Animal.class.getSimpleName()+" eat");</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Date-Time-API-LocalDate-amp-LocalDateTime"><a href="#Date-Time-API-LocalDate-amp-LocalDateTime" class="headerlink" title="Date Time API - LocalDate &amp; LocalDateTime"></a>Date Time API - LocalDate &amp; LocalDateTime</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LocalDateAndTimeAndDateTime</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        localdate();</span></span><br><span class="line"><span class="comment">//        localtime();</span></span><br><span class="line"><span class="comment">//        localdatetime();</span></span><br><span class="line"><span class="comment">//        test1();</span></span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        LocalDateTime localDateTime1 = LocalDateTime.parse(<span class="string">"2016-09-06T06:00:00"</span>);</span><br><span class="line">        LocalDateTime localDateTime2 = LocalDateTime.parse(<span class="string">"2016-09-06T07:00:00"</span>);</span><br><span class="line"><span class="comment">//        System.out.println(localDateTime1.getLong(ChronoField.NANO_OF_DAY));</span></span><br><span class="line">        <span class="keyword">long</span> time1 = localDateTime1.atZone(ZoneId.systemDefault()).toInstant().toEpochMilli();</span><br><span class="line">        <span class="keyword">long</span> time2 = localDateTime2.atZone(ZoneId.systemDefault()).toInstant().toEpochMilli();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">localdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        LocalDate today = LocalDate.now();</span><br><span class="line">        System.out.println(today);</span><br><span class="line"></span><br><span class="line">        LocalDate someday = LocalDate.of(<span class="number">2016</span>,<span class="number">8</span>,<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">        LocalDate withstr = LocalDate.parse(<span class="string">"2016-08-09"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (someday.equals(withstr))</span><br><span class="line">            System.out.println(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            System.out.println(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 取本月第1天：</span></span><br><span class="line">        LocalDate firstDayOfThisMonth = today.with(TemporalAdjusters.firstDayOfMonth()); <span class="comment">// 2016-08-09</span></span><br><span class="line">        <span class="comment">// 取本月第2天：</span></span><br><span class="line">        LocalDate secondDayOfThisMonth = today.withDayOfMonth(<span class="number">2</span>); <span class="comment">// 2016-08-02</span></span><br><span class="line">        <span class="comment">// 取本月最后一天，再也不用计算是28，29，30还是31：</span></span><br><span class="line">        LocalDate lastDayOfThisMonth = today.with(TemporalAdjusters.lastDayOfMonth()); <span class="comment">// 2016-08-31</span></span><br><span class="line">        <span class="comment">// 取下一天：</span></span><br><span class="line">        LocalDate firstDayOf2015 = lastDayOfThisMonth.plusDays(<span class="number">1</span>); <span class="comment">// 变成了2016-09-01</span></span><br><span class="line">        <span class="comment">// 取2016年9月第一个周一，这个计算用Calendar要死掉很多脑细胞：</span></span><br><span class="line">        LocalDate firstMondayOf2015 = LocalDate.parse(<span class="string">"2016-09-01"</span>).with(TemporalAdjusters.firstInMonth(DayOfWeek.MONDAY)); <span class="comment">// 2016-09-05</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">localtime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//包含毫秒</span></span><br><span class="line">        LocalTime now = LocalTime.now();</span><br><span class="line">        System.out.println(now);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//清除毫秒数</span></span><br><span class="line">        LocalTime time = LocalTime.now().withNano(<span class="number">0</span>);</span><br><span class="line">        System.out.println(time);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构造时间</span></span><br><span class="line">        LocalTime zero = LocalTime.of(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// 00:00:00</span></span><br><span class="line">        LocalTime mid = LocalTime.parse(<span class="string">"12:00:00"</span>); <span class="comment">// 12:00:00</span></span><br><span class="line">        System.out.println(zero);</span><br><span class="line">        System.out.println(mid);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">localdatetime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line"><span class="comment">//        LocalDateTime now = LocalDateTime.now();</span></span><br><span class="line"><span class="comment">//        System.out.println(now);</span></span><br><span class="line"><span class="comment">//        LocalDateTime hello = LocalDateTime.parse("2016-08-09T12:00:00:000",DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss:zzz"));</span></span><br><span class="line"><span class="comment">//        System.out.println(hello);</span></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">5</span>;</span><br><span class="line">        System.out.println(System.currentTimeMillis()-start);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.diyishuai.java8.optional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.diyishuai.java8.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Shea</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021-01-20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OptionalDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> isNull = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String id = <span class="string">"666"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.7</span></span><br><span class="line">        Student student = getById(id);</span><br><span class="line">        <span class="keyword">if</span> (student != <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"if : name -&gt; "</span> + student.getName());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.8</span></span><br><span class="line">        Optional&lt;Student&gt; studentOpt = Optional.ofNullable(getById(id));</span><br><span class="line">        studentOpt.ifPresent(s -&gt;</span><br><span class="line">                System.out.println(<span class="string">"opt : name -&gt; "</span> + s.getName())</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Student <span class="title">getById</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isNull ? <span class="keyword">null</span> : <span class="keyword">new</span> Student().setId(id).setName(id + <span class="string">" student"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Base64-java-util-Base64"><a href="#Base64-java-util-Base64" class="headerlink" title="Base64 - java.util.Base64"></a>Base64 - <code>java.util.Base64</code></h3><p>将Base64引入工具包</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.diyishuai.java8.base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Shea</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021-01-20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Base64Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Base64.Encoder encoder = Base64.getEncoder();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Base64.Decoder decoder = Base64.getDecoder();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String str = <span class="string">"Hello Java8, 你好 Java8"</span>;</span><br><span class="line">        System.out.println(<span class="string">"原字符串 -&gt; "</span> + str);</span><br><span class="line"></span><br><span class="line">        String encode = encode(str);</span><br><span class="line">        System.out.println(<span class="string">"Base64 Encode -&gt; "</span> + encode);</span><br><span class="line"></span><br><span class="line">        String decode = decode(encode);</span><br><span class="line">        System.out.println(<span class="string">"Base64 Decode -&gt; "</span> + decode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">decode</span><span class="params">(String encode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(decoder.decode(encode),StandardCharsets.UTF_8);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encode</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> encoder.encodeToString(str.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方法引用"><a href="#方法引用" class="headerlink" title="方法引用"></a>方法引用</h3><ul>
<li>类静态方法引用</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">classStaticFunctionReference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"类静态方法引用"</span>);</span><br><span class="line">    List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">    list.add(<span class="keyword">new</span> Apple(<span class="string">"1"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Apple(<span class="string">"2"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Apple(<span class="string">"3"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Apple[]&#123;<span class="keyword">new</span> Apple(<span class="string">"4"</span>), <span class="keyword">new</span> Apple(<span class="string">"5"</span>)&#125;);</span><br><span class="line"></span><br><span class="line">    list.stream().forEach(Show::show);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> List) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Object o : (List) obj) &#123;</span><br><span class="line">                System.out.print(o.toString() + <span class="string">"\t"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> Object[]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Object o : (Object[]) obj) &#123;</span><br><span class="line">                System.out.print(o.toString() + <span class="string">"\t"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(obj.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实例方法引用</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">instanceFunctionReference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"实例方法引用"</span>);</span><br><span class="line">    List&lt;Apple&gt; list = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">    list.add(<span class="keyword">new</span> Apple(<span class="string">"1"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Apple(<span class="string">"2"</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Apple(<span class="string">"3"</span>));</span><br><span class="line"></span><br><span class="line">    list.stream().map(a -&gt; a.getId()).forEach(System.out::println);</span><br><span class="line">    System.out.println(<span class="string">"----"</span>);</span><br><span class="line">    list.stream().map(Apple::getId).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>类构造方法引用</li>
</ul>
<p>无参构造</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 0 无参构造</span></span><br><span class="line">Supplier&lt;Apple&gt; appleSupplier = Apple::<span class="keyword">new</span>;</span><br><span class="line">Apple a0 = appleSupplier.get();</span><br></pre></td></tr></table></figure>

<p>单参构造</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1 单参构造</span></span><br><span class="line">Function&lt;String, Apple&gt; appleFunction = Apple::<span class="keyword">new</span>;</span><br><span class="line">Apple a1 = appleFunction.apply(<span class="string">"1"</span>);</span><br></pre></td></tr></table></figure>

<p>双参构造</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">BiFunction&lt;String,Double,Apple&gt; appleBiFunction = Apple::<span class="keyword">new</span>;</span><br><span class="line">Apple a2 = appleBiFunction.apply(<span class="string">"2"</span>, <span class="number">0.5</span>);</span><br></pre></td></tr></table></figure>

<h3 id="JVM的新特性-Metaspace-替代-PermGen-space"><a href="#JVM的新特性-Metaspace-替代-PermGen-space" class="headerlink" title="JVM的新特性 - Metaspace 替代 PermGen space"></a>JVM的新特性 - <code>Metaspace</code> 替代 <code>PermGen space</code></h3><p>使用元空间Metaspace代替持久代（PermGen space），</p>
<p>JVM参数使用 <code>-XX:MetaSpaceSize</code> 和 <code>-XX:MaxMetaspaceSize</code> 设置大小。</p>
<h2 id="9"><a href="#9" class="headerlink" title="9"></a>9</h2><p><img src="https://images.di1shuai.com/2021-01-23-9.png" alt></p>
<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><h3 id="不可变集合工厂方法"><a href="#不可变集合工厂方法" class="headerlink" title="不可变集合工厂方法"></a>不可变集合工厂方法</h3><p>&lt; 9 </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// before 9</span></span><br><span class="line">List&lt;String&gt; stringList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">stringList.add(<span class="string">"Hello "</span>);</span><br><span class="line">stringList.add(<span class="string">"Java 9"</span>);</span><br><span class="line">List&lt;String&gt; unmodifiableList = Collections.unmodifiableList(stringList);</span><br></pre></td></tr></table></figure>

<p>9</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// after 9</span></span><br><span class="line">List&lt;String&gt; unmodifiableList_9 = List.of(<span class="string">"Hello "</span>,<span class="string">"Java 9"</span>);</span><br></pre></td></tr></table></figure>

<h3 id="接口支持私有方法"><a href="#接口支持私有方法" class="headerlink" title="接口支持私有方法"></a>接口支持私有方法</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PrivateInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">cantFindMe</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"cant find me"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Optional-改进"><a href="#Optional-改进" class="headerlink" title="Optional 改进"></a>Optional 改进</h3><ul>
<li><code>stream()</code></li>
<li><code>ifPresentOrElse()</code></li>
<li><code>or()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Optional&lt;Integer&gt; optional = Optional.of(<span class="number">1</span>);</span><br><span class="line">optional.ifPresentOrElse(</span><br><span class="line">        x -&gt; System.out.println(<span class="string">"Value: "</span> + x),</span><br><span class="line">        () -&gt; System.out.println(<span class="string">"Not Present."</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">optional = Optional.empty();</span><br><span class="line"></span><br><span class="line">optional.ifPresentOrElse(</span><br><span class="line">        x -&gt; System.out.println(<span class="string">"Value: "</span> + x),</span><br><span class="line">        () -&gt; System.out.println(<span class="string">"Not Present."</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="try-with-resources-改进"><a href="#try-with-resources-改进" class="headerlink" title="try-with-resources 改进"></a><code>try-with-resources</code> 改进</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    System.out.println(readDataBefore9(<span class="string">"TryWithResources"</span>));</span><br><span class="line">    System.out.println(readDataAfter9(<span class="string">"TryWithResources"</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> String <span class="title">readDataBefore9</span><span class="params">(String message)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> (BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> StringReader(message));) &#123;</span><br><span class="line">        <span class="keyword">return</span> br.readLine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> String <span class="title">readDataAfter9</span><span class="params">(String message)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    Reader inputString = <span class="keyword">new</span> StringReader(message);</span><br><span class="line">    BufferedReader br = <span class="keyword">new</span> BufferedReader(inputString);</span><br><span class="line">    <span class="keyword">try</span> (br) &#123;</span><br><span class="line">        <span class="keyword">return</span> br.readLine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Stream-API-更新"><a href="#Stream-API-更新" class="headerlink" title="Stream API 更新"></a>Stream API 更新</h3><ul>
<li><code>takeWhile()</code> 返回第一次遇到false之前的元素</li>
<li><code>dropWhile()</code> 返回第一次遇到false之后的元素</li>
<li><code>iterate</code></li>
<li><code>ofNullable</code></li>
</ul>
<p>原数据</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Supplier&lt;Stream&lt;Integer&gt;&gt; streamSupplier = () -&gt; Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure>

<p><code>takeWhile()</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.out.println(<span class="string">"takeWhile"</span>);</span><br><span class="line">streamSupplier.get()</span><br><span class="line">        .takeWhile(x -&gt; x &lt; <span class="number">3</span>)</span><br><span class="line">        .forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">takeWhile</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><code>dropWhile</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.out.println(<span class="string">"dropWhile"</span>);</span><br><span class="line">        streamSupplier.get()</span><br><span class="line">                .dropWhile(x -&gt; x &lt; <span class="number">3</span>)</span><br><span class="line">                .forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">dropWhile</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>

<p><code>iterate</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.out.println(<span class="string">"iterate"</span>);</span><br><span class="line">IntStream.iterate(<span class="number">2</span>, x -&gt; x &lt; <span class="number">10000</span>, x -&gt; x * x).forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">iterate</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="number">256</span></span><br></pre></td></tr></table></figure>

<p><code>ofNullable</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Stream.ofNullable(<span class="number">100</span>).forEach(System.out::println);</span><br><span class="line">Stream.ofNullable(<span class="keyword">null</span>).forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ofNullable</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>

<h3 id="多版本兼容Jar包"><a href="#多版本兼容Jar包" class="headerlink" title="多版本兼容Jar包"></a>多版本兼容Jar包</h3><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a><strong>其他</strong></h3><ul>
<li>HTTP 2客户端 (支持 WebSocket和 HTTP2 流以及服务器推送)</li>
<li>进程API（控制和管理操作系统进程）</li>
<li>String底层存储结构更改(char[]替换为byte[])</li>
<li>标识符添加限制( String _ =”hello”不能用)</li>
<li>响应式流 API (支持Java 9中的响应式编程)</li>
</ul>
<h2 id="10"><a href="#10" class="headerlink" title="10"></a>10</h2><h3 id="局部变量类型推断"><a href="#局部变量类型推断" class="headerlink" title="局部变量类型推断"></a>局部变量类型推断</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Before 10</span></span><br><span class="line">String str = <span class="string">"hello "</span>;</span><br><span class="line">Integer i = <span class="number">1</span>;</span><br><span class="line">System.out.println(str + i);</span><br><span class="line"></span><br><span class="line"><span class="comment">// After 10</span></span><br><span class="line"><span class="keyword">var</span> obj1 = <span class="string">"hi "</span>;</span><br><span class="line"><span class="keyword">var</span> obj2 = Integer.parseInt(<span class="string">"1"</span>);</span><br><span class="line">System.out.println(obj1 + obj2);</span><br><span class="line">System.out.println(<span class="string">"obj1 -&gt; "</span> + obj1.getClass().getSimpleName());</span><br><span class="line">System.out.println(<span class="string">"obj2 -&gt; "</span> + obj2);</span><br></pre></td></tr></table></figure>

<h3 id="不可变集合更新"><a href="#不可变集合更新" class="headerlink" title="不可变集合更新"></a>不可变集合更新</h3><p>List，Set，Map 提供了一个新的静态方法 <code>copyOf(Collection&lt;? extends E&gt; coll)</code>，它返回Collection集合一个不可修改的副本</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> oldList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">oldList.add(<span class="string">"hello"</span>);</span><br><span class="line">oldList.add(<span class="string">"Java10"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> copyList = List.copyOf(oldList);</span><br><span class="line">oldList.add(<span class="string">"hi"</span>);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    copyList.add(<span class="string">"Java10"</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (UnsupportedOperationException e)&#123;</span><br><span class="line">    System.out.println(<span class="string">"操作不允许"</span>);</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="并行全垃圾回收器G1"><a href="#并行全垃圾回收器G1" class="headerlink" title="并行全垃圾回收器G1"></a>并行全垃圾回收器G1</h3><p>JDK 9引入 G1 作为默认垃圾收集器，执行GC 时采用的是基于单线程标记扫描压缩算法（mark-sweep-compact）。为了最大限度地减少 Full GC 造成的应用停顿的影响，Java 10 中将为 G1 引入多线程并行 GC，同时会使用与年轻代回收和混合回收相同的并行工作线程数量，从而减少了 Full GC 的发生，以带来更好的性能提升、更大的吞吐量。</p>
<h3 id="线程本地握手"><a href="#线程本地握手" class="headerlink" title="线程本地握手"></a>线程本地握手</h3><p>Java 10 中线程管控引入JVM安全点的概念，将允许在不运行全局JVM安全点的情况下实现线程回调，由线程本身或者JVM线程来执行，同时保持线程处于阻塞状态，这将会很方便使得停止单个线程或不停止线程成为可能。</p>
<h3 id="Optional-更新-orElseThrow"><a href="#Optional-更新-orElseThrow" class="headerlink" title="Optional 更新 orElseThrow()"></a>Optional 更新 <code>orElseThrow()</code></h3><p><code>orElseThrow()</code>在没有值时抛出异常</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Optional&lt;String&gt; op;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    op = Optional.of(<span class="keyword">null</span>);</span><br><span class="line">    op.orElseThrow();</span><br><span class="line">&#125; <span class="keyword">catch</span> (RuntimeException e) &#123;</span><br><span class="line">    System.out.println(<span class="string">"捕获到"</span>);</span><br><span class="line">&#125;</span><br><span class="line">op = Optional.of(<span class="string">"hi"</span>);</span><br><span class="line">op.orElseThrow();</span><br><span class="line">System.out.println(op.get());</span><br></pre></td></tr></table></figure>

<h3 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h3><ul>
<li>基于 Java 的 实验性 JIT 编译器</li>
<li>类数据共享</li>
<li>Unicode 语言标签扩展</li>
<li>根证书</li>
<li>基于时间（Time-Based）的版本控制模型</li>
</ul>
<h2 id="11"><a href="#11" class="headerlink" title="11"></a>11</h2><p><img src="https://images.di1shuai.com/2021-01-23-11.png" alt></p>
<h3 id="字符串-API更新"><a href="#字符串-API更新" class="headerlink" title="字符串 API更新"></a>字符串 API更新</h3><p>新增</p>
<ul>
<li>isBlank() 判空。</li>
<li>strip() 去除首尾空格</li>
<li>stripLeading() 去除字符串首部空格</li>
<li>stripTrailing() 去除字符串尾部空格</li>
<li>lines() 分割获取字符串流。</li>
<li>repeat() 复制字符串</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 判空</span></span><br><span class="line">System.out.println(</span><br><span class="line">        <span class="string">"isBlank() -&gt;"</span> +</span><br><span class="line">                <span class="string">""</span>.isBlank() + <span class="string">"\t"</span> +    <span class="comment">// true</span></span><br><span class="line">                <span class="string">"   "</span>.isBlank() + <span class="string">"\t"</span> + <span class="comment">// true</span></span><br><span class="line">                <span class="string">"1"</span>.isBlank() + <span class="string">"\t"</span>    <span class="comment">// false</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">// 去除首尾空格</span></span><br><span class="line">System.out.println(<span class="string">"strip() -&gt;"</span> + <span class="string">"Java11 "</span>.strip()); <span class="comment">//"Java11"</span></span><br><span class="line"><span class="comment">// 去除首部空格</span></span><br><span class="line">System.out.println(<span class="string">"stripLeading() -&gt;"</span> + <span class="string">" Java11 "</span>.stripLeading());   <span class="comment">// "Java11 "</span></span><br><span class="line"><span class="comment">// 去除字符串尾部空格</span></span><br><span class="line">System.out.println(<span class="string">"stripTrailing() -&gt;"</span>+<span class="string">" Java11 "</span>.stripTrailing());   <span class="comment">// " Java11"</span></span><br><span class="line"><span class="comment">// 行数统计</span></span><br><span class="line">System.out.println(<span class="string">"lines() -&gt;"</span>+<span class="string">"a\nb\nc"</span>.lines().count());    <span class="comment">// 3</span></span><br><span class="line"><span class="comment">// 复制字符串</span></span><br><span class="line">System.out.println(<span class="string">"repeat(3) -&gt;"</span>+<span class="string">"Java11"</span>.repeat(<span class="number">3</span>));   <span class="comment">// "Java11Java11Java11"</span></span><br></pre></td></tr></table></figure>

<h3 id="Lambda-推断类型参数的局部变量语法"><a href="#Lambda-推断类型参数的局部变量语法" class="headerlink" title="Lambda 推断类型参数的局部变量语法"></a>Lambda 推断类型参数的局部变量语法</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">map.put(<span class="string">"Hello"</span>, <span class="string">"Java11"</span>);</span><br><span class="line">map.put(<span class="string">"hi"</span>, <span class="number">11</span>);</span><br><span class="line">map.forEach((<span class="keyword">var</span> k, <span class="keyword">var</span> v) -&gt; &#123;</span><br><span class="line">    System.out.println(k + <span class="string">": "</span> + v);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="HTTPClient-标准化"><a href="#HTTPClient-标准化" class="headerlink" title="HTTPClient 标准化"></a>HTTPClient 标准化</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HttpClient client = HttpClient.newHttpClient();</span><br><span class="line">HttpRequest request = HttpRequest.newBuilder()</span><br><span class="line">        .uri(URI.create(<span class="string">"https://di1shuai.com"</span>))</span><br><span class="line">        .GET()</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步</span></span><br><span class="line">HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());</span><br><span class="line">System.out.println(response.body());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步</span></span><br><span class="line">client.sendAsync(request, HttpResponse.BodyHandlers.ofString())</span><br><span class="line">        .thenApply(HttpResponse::body)</span><br><span class="line">        .thenAccept(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="单文件java命令直接编译运行"><a href="#单文件java命令直接编译运行" class="headerlink" title="单文件java命令直接编译运行"></a>单文件java命令直接编译运行</h3><p>Before 11</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 编译</span></span><br><span class="line">javac Hello.java</span><br><span class="line"><span class="comment">// 运行</span></span><br><span class="line">java Hello</span><br></pre></td></tr></table></figure>

<p>11</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java Hello.java</span><br></pre></td></tr></table></figure>

<h3 id="ZGC-可伸缩低延迟垃圾收集器"><a href="#ZGC-可伸缩低延迟垃圾收集器" class="headerlink" title="ZGC-可伸缩低延迟垃圾收集器"></a>ZGC-可伸缩低延迟垃圾收集器</h3><p>ZGC ，即 Z Garbage Collector（垃圾收集器或垃圾回收器）。它是一个可伸缩的、低延迟的垃圾收集器。ZGC 主要为了满足如下目标进行设计：</p>
<ul>
<li>GC 停顿时间不超过 10ms</li>
<li>既能处理几百 MB 的小堆，也能处理几个 TB 的大堆</li>
<li>应用吞吐能力不会下降超过 15%（与 G1 回收算法相比）</li>
<li>方便在此基础上引入新的 GC 特性和利用 colord</li>
<li>针以及 Load barriers 优化奠定基础</li>
<li>只支持 Linux/x64 位平台</li>
</ul>
<h3 id="其他-2"><a href="#其他-2" class="headerlink" title="其他"></a><strong>其他</strong></h3><ul>
<li>添加 Epsilon 垃圾收集器。</li>
<li>支持 TLS 1.3 协议</li>
<li>飞行记录器分析工具</li>
<li>动态类文件常量</li>
<li>低开销的 Heap Profiling</li>
</ul>
<h2 id="12"><a href="#12" class="headerlink" title="12"></a>12</h2><p><img src="https://images.di1shuai.com/2021-01-23-12.png" alt></p>
<h3 id="switch-增强-预览"><a href="#switch-增强-预览" class="headerlink" title="switch 增强(预览)"></a>switch 增强(预览)</h3><p>支持case多个</p>
<p>before 12</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> (day) &#123;</span><br><span class="line">    <span class="keyword">case</span> MONDAY:</span><br><span class="line">    <span class="keyword">case</span> TUESDAY:</span><br><span class="line">    <span class="keyword">case</span> WEDNESDAY:</span><br><span class="line">    <span class="keyword">case</span> THURSDAY:</span><br><span class="line">    <span class="keyword">case</span> FRIDAY:</span><br><span class="line">        today = TODAY.WORKING_DAY;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> SATURDAY:</span><br><span class="line">    <span class="keyword">case</span> SUNDAY:</span><br><span class="line">        today = TODAY.WEEKEND_DAY;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"N/A"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>12</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> (day) &#123;</span><br><span class="line">      <span class="keyword">case</span> MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY </span><br><span class="line">							-&gt; today = TODAY.WORKING_DAY;</span><br><span class="line">      <span class="keyword">case</span> SATURDAY, SUNDAY </span><br><span class="line">							-&gt; today = TODAY.WEEKEND_DAY;</span><br><span class="line">      <span class="keyword">default</span> -&gt; <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Invalid day"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="NumberFormat-数字的格式化"><a href="#NumberFormat-数字的格式化" class="headerlink" title="NumberFormat - 数字的格式化"></a><code>NumberFormat</code> - 数字的格式化</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">long</span> number = <span class="number">100000</span>;</span><br><span class="line">NumberFormat nfChina = NumberFormat.getCompactNumberInstance(Locale.CHINA, NumberFormat.Style.SHORT);</span><br><span class="line">System.out.println(nfChina.format(number));</span><br><span class="line"><span class="comment">//10万</span></span><br><span class="line">NumberFormat nfUK = NumberFormat.getCompactNumberInstance(Locale.UK, NumberFormat.Style.SHORT);</span><br><span class="line">System.out.println(nfUK.format(number));</span><br><span class="line"><span class="comment">//100K</span></span><br></pre></td></tr></table></figure>

<h3 id="字符串支持transform、indent操作"><a href="#字符串支持transform、indent操作" class="headerlink" title="字符串支持transform、indent操作"></a>字符串支持transform、indent操作</h3><ul>
<li>transform 转换,可以配合函数式接口Function一起使用</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//transform</span></span><br><span class="line">List.of(<span class="string">"    Hello    "</span>, <span class="string">"   Hi   "</span>).forEach(</span><br><span class="line">        s -&gt; &#123;</span><br><span class="line">            String newStr = s.transform(String::strip)</span><br><span class="line">                    .transform(e -&gt; e + <span class="string">" Java 12"</span>);</span><br><span class="line">            System.out.println(newStr);</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Hello Java <span class="number">12</span></span><br><span class="line">Hi Java <span class="number">12</span></span><br></pre></td></tr></table></figure>

<ul>
<li>indent 缩进，每行开头增加空格space和移除空格</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//indent</span></span><br><span class="line">String result = <span class="string">"Hello\nJava\n12\n"</span>.indent(<span class="number">3</span>);</span><br><span class="line">System.out.println(result);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Hello</span><br><span class="line">Java</span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>

<h3 id="Files-mismatch-Path-Path"><a href="#Files-mismatch-Path-Path" class="headerlink" title="Files.mismatch(Path, Path)"></a>Files.mismatch(Path, Path)</h3><p>文件比较 返回第一个不匹配的位置，如果没有不匹配，则返回 -1L</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Path path1 = Paths.get(<span class="string">"/Users/shuai/Documents/GitRepo/mine/language/java-versions/java-12/src/main/java/com/di1shuai/java12/files/FilesDemo.java"</span>);</span><br><span class="line">Path path2 = Paths.get(<span class="string">"/Users/shuai/Documents/GitRepo/mine/language/java-versions/java-12/src/main/java/com/di1shuai/java12/files/FilesDemo.java"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">long</span> fileMismatch = Files.mismatch(path1, path2);</span><br><span class="line">    System.out.println(fileMismatch);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Teeing-Collector"><a href="#Teeing-Collector" class="headerlink" title="Teeing Collector"></a>Teeing Collector</h3><p>Teeing Collector 是 Streams API 中引入的新的收集器实用程序，它的作用是 merge 两个 collector 的结果</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;Student&gt; students = Arrays.asList(</span><br><span class="line">        <span class="keyword">new</span> Student(<span class="string">"shea"</span>, <span class="number">28</span>),</span><br><span class="line">        <span class="keyword">new</span> Student(<span class="string">"abel"</span>, <span class="number">25</span>),</span><br><span class="line">        <span class="keyword">new</span> Student(<span class="string">"sean"</span>, <span class="number">40</span>)</span><br><span class="line">);</span><br><span class="line">String collect = students.stream().collect(Collectors.teeing(</span><br><span class="line">        Collectors.averagingInt(Student::getAge),</span><br><span class="line">        Collectors.summingInt(Student::getAge),</span><br><span class="line">        (avgAge, sumAge) -&gt; avgAge + <span class="string">" : "</span> + sumAge</span><br><span class="line">));</span><br><span class="line">System.out.println(collect);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">31.0</span> : <span class="number">93</span></span><br></pre></td></tr></table></figure>

<h3 id="其他-3"><a href="#其他-3" class="headerlink" title="其他"></a><strong>其他</strong></h3><ul>
<li>支持unicode 11（684个新字符、11个新blocks、7个新脚本）</li>
<li>JVM 常量 API （主要在新的java.lang.invoke.constant包中定义了一系列基于值的符号引用类型，能够描述每种可加载常量。）</li>
<li>Shenandoah GC（低暂停时间垃圾收集器）</li>
<li>G1 收集器提升 （可中止的混合收集集合、及时返回未使用的已分配内存）</li>
<li>默认CDS档案</li>
<li>JMH 基准测试</li>
</ul>
<h2 id="13"><a href="#13" class="headerlink" title="13"></a>13</h2><p><img src="https://images.di1shuai.com/2021-01-23-13.png" alt></p>
<h3 id="Switch-增强-yield"><a href="#Switch-增强-yield" class="headerlink" title="Switch 增强 - yield"></a>Switch 增强 - yield</h3><p>yield可直接返回值</p>
<p>&lt;13</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Before 13</span></span><br><span class="line">TODAY today;</span><br><span class="line"><span class="keyword">switch</span> (day) &#123;</span><br><span class="line">    <span class="keyword">case</span> MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY </span><br><span class="line">				-&gt; today = TODAY.WORKING_DAY;</span><br><span class="line">    <span class="keyword">case</span> SATURDAY, SUNDAY </span><br><span class="line">				-&gt; today = TODAY.WEEKEND_DAY;</span><br><span class="line">    <span class="keyword">default</span> </span><br><span class="line">				-&gt; <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Invalid day"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> today;</span><br></pre></td></tr></table></figure>

<p>13</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">switch</span> (day) &#123;</span><br><span class="line">    <span class="keyword">case</span> MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY -&gt; &#123;</span><br><span class="line">        yield TODAY.WORKING_DAY;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> SATURDAY, SUNDAY -&gt; &#123;</span><br><span class="line">        yield TODAY.WEEKEND_DAY;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span> -&gt; <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Invalid day"</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="String文本块"><a href="#String文本块" class="headerlink" title="String文本块"></a>String文本块</h3><p>&lt;13</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String html = <span class="string">"&lt;html&gt;\n"</span> +</span><br><span class="line">              <span class="string">"    &lt;body&gt;\n"</span> +</span><br><span class="line">              <span class="string">"        &lt;p&gt;Hello, Java 13&lt;/p&gt;\n"</span> +</span><br><span class="line">              <span class="string">"    &lt;/body&gt;\n"</span> +</span><br><span class="line">              <span class="string">"&lt;/html&gt;\n"</span>;</span><br></pre></td></tr></table></figure>

<p>13</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String html13 = <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">                &lt;html&gt;</span></span><br><span class="line"><span class="string">                    &lt;body&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;Hello,  Java 13&lt;/p&gt;</span></span><br><span class="line"><span class="string">                    &lt;/body&gt;</span></span><br><span class="line"><span class="string">                &lt;/html&gt;</span></span><br><span class="line"><span class="string">                "</span><span class="string">""</span>;</span><br></pre></td></tr></table></figure>

<h3 id="SocketAPI-重构"><a href="#SocketAPI-重构" class="headerlink" title="SocketAPI 重构"></a>SocketAPI 重构</h3><p>传统的Java Socket API（java.net.ServerSocket 和 java.net.Socket）依赖于SocketImpl 的内部实现</p>
<p>在 Java 13之前，通过使用 PlainSocketImpl 作为 SocketImpl 的具体实现。</p>
<p>Java 13 中的新底层实现，引入 NioSocketImpl 的实现用以替换 SocketImpl 的 PlainSocketImpl 实现，此实现与 NIO（新 I/O）实现共享相同的内部基础结构，并且与现有的缓冲区高速缓存机制集成在一起。</p>
<h3 id="FileSystems-newFileSystem"><a href="#FileSystems-newFileSystem" class="headerlink" title="FileSystems.newFileSystem"></a>FileSystems.newFileSystem</h3><p>FileSystems 类中添加了以下三种新方法，以便更容易地使用将文件内容视为文件系统的文件系统提供程序：</p>
<ul>
<li>newFileSystem(Path)</li>
<li>newFileSystem(Path, Map&lt;String, ?&gt;)</li>
<li>newFileSystem(Path, Map&lt;String, ?&gt;, ClassLoader)</li>
</ul>
<h3 id="ZGC-增强-释放未使用内存"><a href="#ZGC-增强-释放未使用内存" class="headerlink" title="ZGC 增强 - 释放未使用内存"></a><strong>ZGC 增强 - 释放未使用内存</strong></h3><p>ZGC 是Java 11 中引入的最为瞩目的垃圾回收特性，是一种可伸缩、低延迟的垃圾收集器。但是实际使用中，它不能够主动将未使用的内存释放给操作系统。</p>
<p>Java 13 中对 ZGC 的改进，包括释放未使用内存给操作系统、支持最大堆大小为 16TB、JVM参数 <code>-XX:SoftMaxHeapSize</code> 来软限制堆大小</p>
<h3 id="其他-4"><a href="#其他-4" class="headerlink" title="其他"></a><strong>其他</strong></h3><ul>
<li>动态 CDS 存档， 扩展了 Java 10 中引入的类数据共享功能， 使用CDS 存档变得更容易。</li>
<li>文本块的字符串类新方法，如formatted(Object…args)，stripIndent()等。</li>
</ul>
<h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2><h3 id="instanceof-模式匹配改进"><a href="#instanceof-模式匹配改进" class="headerlink" title="instanceof 模式匹配改进"></a>instanceof 模式匹配改进</h3><p>&lt;14</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Object obj = <span class="string">"  hello Java 14  "</span>;</span><br><span class="line"><span class="comment">// &lt; 14</span></span><br><span class="line"><span class="keyword">if</span> (obj <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">    System.out.println(((String) obj).strip());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>14</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Object obj = <span class="string">"  hello Java 14  "</span>;</span><br><span class="line"><span class="comment">// 14</span></span><br><span class="line"><span class="keyword">if</span> (obj <span class="keyword">instanceof</span> String str) &#123;</span><br><span class="line">    System.out.println(str.strip());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="switch-表达式-标准化"><a href="#switch-表达式-标准化" class="headerlink" title="switch 表达式 - 标准化"></a>switch 表达式 - 标准化</h3><h3 id="Record-类型（预览功能）"><a href="#Record-类型（预览功能）" class="headerlink" title="Record 类型（预览功能）"></a>Record 类型（预览功能）</h3><p>recode</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 构造方法</span></span><br><span class="line"><span class="comment"> * hashCode() 方法</span></span><br><span class="line"><span class="comment"> * euqals() 方法</span></span><br><span class="line"><span class="comment"> * toString() 方法</span></span><br><span class="line"><span class="comment"> * 类对象被final 关键字修饰，不能被继承。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">record <span class="title">Student</span><span class="params">(String name,<span class="keyword">int</span> age)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Student s = <span class="keyword">new</span> Student(<span class="string">"shea"</span>,<span class="number">18</span>);</span><br><span class="line">        System.out.println(</span><br><span class="line">                <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">                getName  -&gt; %s        </span></span><br><span class="line"><span class="string">                getAge   -&gt; %s</span></span><br><span class="line"><span class="string">                toString -&gt; %s</span></span><br><span class="line"><span class="string">                hashCode -&gt; %s        </span></span><br><span class="line"><span class="string">                "</span><span class="string">""</span>.formatted(</span><br><span class="line">                        s.name(),</span><br><span class="line">                        s.age(),</span><br><span class="line">                        s.toString(),</span><br><span class="line">                        s.hashCode()</span><br><span class="line">                )</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="NullPointerException-提示改进"><a href="#NullPointerException-提示改进" class="headerlink" title="NullPointerException 提示改进"></a>NullPointerException 提示改进</h3><p>14默认开启 <code>XX:+ShowCodeDetailsInExceptionMessages</code> 来显示详细信息</p>
<p>&lt;14</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">java</span><span class="selector-class">.lang</span><span class="selector-class">.NullPointerException</span></span><br><span class="line">  <span class="selector-tag">at</span> <span class="selector-tag">com</span><span class="selector-class">.di1shuai</span><span class="selector-class">.java14</span><span class="selector-class">.nullexception</span><span class="selector-class">.NullPointerExceptionDemo</span><span class="selector-class">.main</span>(<span class="selector-tag">NullPointerExceptionDemo</span><span class="selector-class">.java</span><span class="selector-pseudo">:21)</span></span><br></pre></td></tr></table></figure>

<p>14</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">Exception</span> <span class="selector-tag">in</span> <span class="selector-tag">thread</span> "<span class="selector-tag">main</span>" <span class="selector-tag">java</span><span class="selector-class">.lang</span><span class="selector-class">.NullPointerException</span>: <span class="selector-tag">Cannot</span> <span class="selector-tag">invoke</span> "<span class="selector-tag">String</span><span class="selector-class">.toString</span>()" <span class="selector-tag">because</span> "<span class="selector-tag">str</span>" <span class="selector-tag">is</span> <span class="selector-tag">null</span></span><br><span class="line">  <span class="selector-tag">at</span> <span class="selector-tag">com</span><span class="selector-class">.di1shuai</span><span class="selector-class">.java14</span><span class="selector-class">.nullexception</span><span class="selector-class">.NullPointerExceptionDemo</span><span class="selector-class">.main</span>(<span class="selector-tag">NullPointerExceptionDemo</span><span class="selector-class">.java</span><span class="selector-pseudo">:12)</span></span><br></pre></td></tr></table></figure>

<h3 id="其他-5"><a href="#其他-5" class="headerlink" title="其他"></a><strong>其他</strong></h3><ul>
<li>G1 的 NUMA 可识别内存分配</li>
<li>删除 CMS 垃圾回收器</li>
<li>GC 支持 MacOS 和 Windows 系统</li>
</ul>
<h2 id="15"><a href="#15" class="headerlink" title="15"></a>15</h2><p><img src="https://images.di1shuai.com/2021-01-23-15.png" alt></p>
<h3 id="EdDSA-数字签名算法"><a href="#EdDSA-数字签名算法" class="headerlink" title="EdDSA 数字签名算法"></a>EdDSA 数字签名算法</h3><ul>
<li>使用 Edwards-Curve 数字签名算法（EdDSA）实现加密签名。</li>
<li>与其它签名方案相比，EdDSA 具有更高的安全性和性能。</li>
<li>得到许多其它加密库（如 OpenSSL、BoringSSL）的支持。</li>
</ul>
<h3 id="Sealed-Classes（封闭类，预览）"><a href="#Sealed-Classes（封闭类，预览）" class="headerlink" title="Sealed Classes（封闭类，预览）"></a>Sealed Classes（封闭类，预览）</h3><p>封闭类 <code>sealed</code> class<br><code>permits</code>可以允许三种类型的子类进行继承</p>
<ol>
<li>final 类</li>
<li>non-sealed 不封闭类</li>
<li>sealed 类</li>
</ol>
<p>封闭父类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> sealed <span class="class"><span class="keyword">class</span> <span class="title">SealedDemo</span></span></span><br><span class="line"><span class="class">        <span class="title">permits</span> <span class="title">FinalClass</span>, <span class="title">NonSealedClass</span>, <span class="title">SealedClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>final</code></p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">FinalClass</span> <span class="keyword">extends</span> <span class="title">SealedDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>non-sealed</code></p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">non-<span class="keyword">sealed</span> <span class="class"><span class="keyword">class</span> <span class="title">NonSealedClass</span> <span class="keyword">extends</span> <span class="title">SealedDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>sealed</code></p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sealed</span> <span class="class"><span class="keyword">class</span> <span class="title">SealedClass</span> <span class="keyword">extends</span> <span class="title">SealedDemo</span> <span class="title">permits</span> <span class="title">SealedClass</span>.<span class="title">SubSealed</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    non-<span class="keyword">sealed</span> <span class="class"><span class="keyword">class</span> <span class="title">SubSealed</span> <span class="keyword">extends</span> <span class="title">SealedClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Hidden-Classes（隐藏类）"><a href="#Hidden-Classes（隐藏类）" class="headerlink" title="Hidden Classes（隐藏类）"></a>Hidden Classes（隐藏类）</h3><p>隐藏类天生为框架设计的。</p>
<p>隐藏类只能通过反射访问，不能直接被其他类的字节码</p>
<h3 id="其他-6"><a href="#其他-6" class="headerlink" title="其他"></a>其他</h3><ul>
<li>Disable and Deprecate Biased Locking（准备禁用偏向锁）</li>
<li>instanceof 自动匹配模式（二次预览）</li>
<li>ZGC，一个可伸缩、低延迟的垃圾回收器。（转正）</li>
<li>Text Blocks，文本功能转正（JDK 13和14预览，14终于转正）</li>
<li>Remove the Solaris and SPARC Ports（删除 Solaris 和 SPARC 端口）</li>
<li>外部存储器访问 API（允许Java 应用程序安全有效地访问 Java 堆之外的外部内存。）</li>
<li>Record类型二次预览（在Java 14就预览过啦）</li>
</ul>
<h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p><a href="https://github.com/BestBurning/java-versions" target="_blank" rel="noopener">源码</a>已发布在Github上，欢迎Star</p>

      <script>
        window.disqusProxy={
          shortname: 'diyishuai',
          username: 'di1shuai',
          server: 'disqus.di1shuai.com',
          port: 443,
          adminAvatar: '/avatars/admin-avatar.jpg',
          identifier: 'Java各版本新特性.html',
        };
        window.disqus_config = function () {
          this.page.url = window.location.href;
          this.page.identifier = window.disqusProxy.identifier;
        };
      </script></div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css"><p><span>本文标题：</span>Java各版本新特性</p><p><span>文章作者：</span>Shea</p><p><span>原始链接：</span><a href="/Java各版本新特性.html">https://di1shuai.com/Java各版本新特性.html</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://di1shuai.com/Java各版本新特性.html"></i></span></p><p><span>版权声明：</span>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</p></div><br><div class="tags"><a href="/tags/Java/"><i class="fa fa-tag"></i>Java</a></div><div class="post-nav"><a class="pre" href="/设计模式之行为型.html">设计模式之行为型</a><a class="next" href="/Kafka——分区策略.html">Kafka——分区策略</a></div>
      <script src="//cdn.bootcss.com/react/16.0.0/umd/react.production.min.js"></script>
      <script src="//cdn.bootcss.com/react-dom/16.0.0/umd/react-dom.production.min.js"></script>
      <script src="//cdn.bootcss.com/fetch/2.0.3/fetch.min.js"></script>
      <script src="//cdn.jsdelivr.net/npm/blockies-identicon@0.1.0/blockies.min.js"></script>
      <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
      <div id="disqus_proxy_thread"><script src="/scripts/hexo-disqus-proxy-primary.js" async></script><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://di1shuai.com/Java各版本新特性.html';
    this.page.identifier = 'Java各版本新特性.html';
    this.page.title = 'Java各版本新特性';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//diyishuai.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//diyishuai.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://diyishuai.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://di1shuai.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/emotion/">emotion</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/products/">products</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/technology/">technology</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/Flink数据转换-Transformation.html">Flink-DataStream-Transformations</a></li><li class="post-list-item"><a class="post-list-link" href="/Kubernetes架构.html">Kubernetes架构</a></li><li class="post-list-item"><a class="post-list-link" href="/使用GithubAction推送Docker到华为镜像中心.html">使用GithubAction推送Docker到香港华为镜像中心</a></li><li class="post-list-item"><a class="post-list-link" href="/docker-compose安装单机Elasticsearch.html">docker-compose安装单机Elasticsearch</a></li><li class="post-list-item"><a class="post-list-link" href="/使用GithubAction发布Flutter项目.html">使用GithubAction发布Flutter项目-Android</a></li><li class="post-list-item"><a class="post-list-link" href="/招行积分题.html">招行积分题</a></li><li class="post-list-item"><a class="post-list-link" href="/设计模式之行为型.html">设计模式之行为型</a></li><li class="post-list-item"><a class="post-list-link" href="/Java各版本新特性.html">Java各版本新特性</a></li><li class="post-list-item"><a class="post-list-link" href="/Kafka——分区策略.html">Kafka——分区策略</a></li><li class="post-list-item"><a class="post-list-link" href="/Kafka——Rebalance过程.html">Kafka——Rebalance过程</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://blog.csdn.net/u012373815" title="Abel的博客(大数据、AI专家)" target="_blank">Abel的博客(大数据、AI专家)</a><ul></ul><a href="https://blog.csdn.net/u010416101" title="Sean的博客(大数据、AI专家)" target="_blank">Sean的博客(大数据、AI专家)</a><ul></ul><a href="https://yo-cwj.com/" title="陈文俊的博客(前端专家)" target="_blank">陈文俊的博客(前端专家)</a><ul></ul><a href="https://www.xilanhua-c7.top" title="西蓝花的博客(未知领域专家)" target="_blank">西蓝花的博客(未知领域专家)</a><ul></ul><a href="https://gaojianchao.github.io/learngit/" title="Alan的博客(AI专家)" target="_blank">Alan的博客(AI专家)</a><ul></ul><a href="https://woj.app" title="虾米的蜗居" target="_blank">虾米的蜗居</a><ul></ul><a href="https://blog.mightyherox.me" title="circlehotarux的博客" target="_blank">circlehotarux的博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2016-2021 <a href="/." rel="nofollow">第一帅 </a> |&nbsp;<a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn"> 晋ICP备15004021号-1</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.1" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/love.js"></script><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.1"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.1"></script></div></body></html>